
#include <stdio.h>

#define INI_IMPLEMENTATION
#include "ini.h"

ini_t* read_ini_file(const char* path);

int main(int argc, char** argv) {

  ini_t* ini = read_ini_file("foo.ini");


  int count =  ini_section_count(ini);
  printf("COUNT: %d\n", count);

  for (int i = 1; i < count; i++) {
    char const* name = ini_section_name(ini, i);
    printf("NAME: %s\n", name);

    // Now get the urls for the section name
    int dindex = ini_find_property(ini, i, "description", -1);
	  char const* description = ini_property_value(ini, i, dindex);
    printf("  DESCRIPTION: %s\n", description);

    printf("\n");
  }


	ini_destroy(ini);

  return 0;
}

ini_t* read_ini_file(const char* path) {
	FILE* fp = fopen("foo.ini", "r");
	fseek(fp, 0, SEEK_END);
	int size = ftell(fp);
	fseek(fp, 0, SEEK_SET);
	char* data = (char*) malloc(size + 1);
	fread(data, 1, size, fp);
	data[size] = '\0';
	fclose(fp);

	ini_t* ini = ini_load(data, NULL);
	free(data);

  return ini;
}

// vim: tabstop=2 shiftwidth=2 expandtab autoindent softtabstop=0
